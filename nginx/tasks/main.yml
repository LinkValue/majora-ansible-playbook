---

- name: Add nginx ppa
  apt_repository: repo="ppa:nginx/stable" state=present

- name: Install nginx
  apt: name={{ nginx_package }} state=present

- name: Push virtualhost configuration files
  template: src={{ item.template|default('vhost.symfony2.j2') }} dest=/etc/nginx/sites-enabled/{{ item.dest|default(item.name)}}
  with_items: sites
  when: sites is defined
  notify:
    - Restart nginx
