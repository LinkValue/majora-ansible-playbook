- name: Commmon | Update repository
  action: command /usr/bin/apt-get update

- name: Set TZ config file
  template:
    src=timezone.j2
    dest=/etc/timezone
  register: tz_result

- name: Set .bash_aliases file
  template:
    src=bash_aliases.j2
    dest=~/.bash_aliases

# - name: Common | Reconfigure TZ
#   command: dpkg-reconfigure tzdata
#   when: tz_result.changed

# - name: Configure language packs
#   command: locale-gen fr_FR fr_FR.UTF-8 && dpkg-reconfigure locales

- name: install common packages
  action: apt pkg={{item}} state=installed
  with_items:
    - language-pack-fr
    - build-essential
    - software-properties-common
    - python-software-properties
    - vim
    - zsh
    - acl
    - curl
    - wget
    - git
    - python-pycurl
    - unzip
    - ntp

- name: Clone oh-my-zsh repo
  git: repo=https://github.com/robbyrussell/oh-my-zsh.git dest=/home/vagrant/.oh-my-zsh

- name: Create conf folder in home directory
  file: path=/home/vagrant/conf/ state=directory owner=vagrant

- name: deploy .zshrc
  template: src=zshrc.in dest=/home/vagrant/conf/zshrc owner=vagrant

- name: remove standard zshrc
  file: path=/home/vagrant/.zshrc state=absent

- name: symlink zshrc
  file: path=/home/vagrant/.zshrc src=/home/vagrant/conf/zshrc state=link owner=vagrant

- name: Set zsh as default shell
  user: name=vagrant shell=/bin/zsh
